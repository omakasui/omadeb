#!/bin/bash

# Add the named packages to the system if they're missing. Returns false if it couldn't be done.

if omadeb-pkg-missing "$@"; then
  sudo apt -y install "$@" || exit 1
fi

for pkg in "$@"; do
  # Secondary check to handle states where dpkg doesn't actually register an error
  if ! dpkg -l | grep -q "$pkg"; then
    echo -e "\033[31mError: Package '$pkg' did not install\033[0m" >&2
    exit 1
  fi
done

exit 0
